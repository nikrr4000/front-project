name: Sync From Backend

on:
  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ—Ç workflow –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ API (–∏–∑ –±—ç–∫–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
  workflow_dispatch:

jobs:
  sync-directory:
    runs-on: ubuntu-latest
    steps:
      # 1. –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      - name: Checkout Frontend Repo
        uses: actions/checkout@v4
        with:
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º PAT, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –ø—Ä–∞–≤–æ –¥–µ–ª–∞—Ç—å git push –≤ —ç—Ç–æ—Ç –∂–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
          token: ${{ secrets.BACKEND_ACCESS_TOKEN }}

      # 2. –ö–ª–æ–Ω–∏—Ä—É–µ–º –±—ç–∫–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É 'temp-backend'
      - name: Clone Backend Repo
        run: |
          git clone https://${{ secrets.BACKEND_ACCESS_TOKEN }}@github.com/nikrr4000/back-project.git temp-backend
          # üëÜ –ó–∞–º–µ–Ω–∏—Ç–µ YOUR_USERNAME/BACKEND_REPO_NAME –Ω–∞ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É –±—ç–∫–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é

      # 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø–æ–º–æ—â—å—é rsync
      - name: Sync Directory from Backend
        run: |
          rsync -av --delete temp-backend/src/config src/config
          # üëÜ –ó–∞–º–µ–Ω–∏—Ç–µ PATH_TO_BACKEND_DIR (–Ω–∞–ø—Ä–∏–º–µ—Ä, src/api/types)
          # üëÜ –∏ PATH_TO_FRONTEND_DIR (–Ω–∞–ø—Ä–∏–º–µ—Ä, src/shared-types)

      # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –¥–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç –∏ –ø—É—à
      - name: Commit and Push Changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore(sync): Update files from backend repository"
          # –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ

          commit_user_name: "GitHub Actions Bot"
          commit_user_email: "github-actions[bot]@users.noreply.github.com"
          commit_author: "GitHub Actions Bot <github-actions[bot]@users.noreply.github.com>"

          # –î–æ–±–∞–≤–ª—è–µ–º [skip ci] –≤ –∫–æ–Ω–µ—Ü —Å–æ–æ–±—â–µ–Ω–∏—è, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –∫–æ–º–º–∏—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª –¥—Ä—É–≥–∏–µ Actions
          # –∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å workflow –Ω–∞ push.
          commit_options: '--no-verify --signoff -m "[skip ci]"'
