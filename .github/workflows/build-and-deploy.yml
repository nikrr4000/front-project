name: Sync From Backend

on:
  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ—Ç workflow –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ API (–∏–∑ –±—ç–∫–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
  workflow_dispatch:

jobs:
  sync-directory:
    runs-on: ubuntu-latest
    steps:
      # 1. –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      - name: Checkout Frontend Repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.BACKEND_ACCESS_TOKEN }}

      # 2. –ö–ª–æ–Ω–∏—Ä—É–µ–º –±—ç–∫–µ–Ω–¥-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É
      - name: Clone Backend Repo
        run: |
          git clone https://${{ secrets.BACKEND_ACCESS_TOKEN }}@github.com/nikrr4000/back-project.git temp-backend

      # 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∏ —É–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É
      - name: Sync Directory and Cleanup
        run: |
          # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
          mkdir -p src/config

          # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
          rsync -av --delete temp-backend/src/config/ src/config/

          # –°–†–ê–ó–£ –£–î–ê–õ–Ø–ï–ú –í–†–ï–ú–ï–ù–ù–£–Æ –ü–ê–ü–ö–£, –ß–¢–û–ë–´ –û–ù–ê –ù–ï –ü–û–ü–ê–õ–ê –í –ö–û–ú–ú–ò–¢ üëà
          rm -rf temp-backend

      # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –¥–µ–ª–∞–µ–º –∫–æ–º–º–∏—Ç –∏ –ø—É—à
      - name: Commit and Push Changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï –ö–û–ú–ú–ò–¢–ê üëà
          commit_message: "chore(sync): Update files from backend repository [skip ci]"

          commit_user_name: "GitHub Actions Bot"
          commit_user_email: "github-actions[bot]@users.noreply.github.com"
          commit_author: "GitHub Actions Bot <github-actions[bot]@users.noreply.github.com>"

          # –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –û–ü–¶–ò–ò –ö–û–ú–ú–ò–¢–ê üëà
          commit_options: "--no-verify --signoff"
